<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soltiva</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/manifest.webmanifest" id="app-manifest" />
    <meta name="theme-color" content="#6aa1ff" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    
    <!-- Dynamic Manifest and Title Script -->
<script>
  (function() {
    try {
      const tenantId = localStorage.getItem('activeTenantId')
      if (tenantId) {
        const v = Date.now()
        
        // Set dynamic manifest
        const manifestLink = document.getElementById('app-manifest')
        if (manifestLink) {
          manifestLink.href = `/api/manifest?tenant_id=${tenantId}&v=${v}`
        }
        
        // Fetch and set dynamic title from tenant data
        fetch(`/.netlify/functions/serve-icon?tenant_id=${tenantId}&type=name`)
          .then(res => res.json())
          .then(data => {
            if (data.app_name) {
              document.title = data.app_name
            }
          })
          .catch(() => {
            console.log('Using static title')
          })
      }
    } catch (e) {
      console.log('Using static manifest and title')
    }
  })()
</script>
    
    <!-- Dynamic Favicon and iOS Icon Script -->
<script>
  (function () {
    try {
      const tenantId = localStorage.getItem('activeTenantId')
      if (!tenantId) return

      const v = Date.now()

      // Favicon
      const iconLink =
        document.querySelector("link[rel*='icon']") || document.createElement('link')
      iconLink.type = 'image/x-icon'
      iconLink.rel = 'shortcut icon'
      iconLink.href = `/.netlify/functions/serve-icon?tenant_id=${tenantId}&type=favicon&v=${v}`
      document.head.appendChild(iconLink)

      // Apple touch icon (iOS Add to Home Screen)
      const appleLink =
        document.querySelector("link[rel='apple-touch-icon']") || document.createElement('link')
      appleLink.rel = 'apple-touch-icon'
      appleLink.href = `/.netlify/functions/serve-icon?tenant_id=${tenantId}&type=192&v=${v}`
      document.head.appendChild(appleLink)

      // Optional 512
      const appleLink512 = document.createElement('link')
      appleLink512.rel = 'apple-touch-icon'
      appleLink512.sizes = '512x512'
      appleLink512.href = `/.netlify/functions/serve-icon?tenant_id=${tenantId}&type=512&v=${v}`
      document.head.appendChild(appleLink512)
    } catch (e) {}
  })()
</script>

  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
